<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Activities</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous" />
    <script type="importmap">
            {
              "imports": {
                "React": "https://unpkg.com/es-react@latest/dev/react.js",
                "ReactDOM": "https://unpkg.com/es-react@latest/dev/react-dom.js",
                "htm": "https://unpkg.com/htm@latest?module"
              }
            }
          </script>

    <style>
        .bd-placeholder-img {
            font-size: 1.125rem;
            text-anchor: middle;
            -webkit-user-select: none;
            -moz-user-select: none;
            user-select: none;
        }

        .vertical-center {
            margin: 0;
            position: absolute;
            top: 50%;
            -ms-transform: translateY(-50%);
            transform: translateY(-50%);
        }

        @media (min-width: 768px) {
            .bd-placeholder-img-lg {
                font-size: 3.5rem;
            }
        }


        #h1 {
            transition: background 1s;
        }

        body {
            font: larger;
            font-family: 'Courier New', Courier, monospace;
            font-weight: normal;
        }

        #myVid {
            position: fixed;
            right: 0;
            bottom: 1;
            min-width: 100%;
            min-height: 100%;
            z-index: -100;
            background-image: url(joel-filipe-unsplash.jpg);
            background-position: center;
            background-size: cover;
            background-repeat: no-repeat;
        }
    </style>

</head>

<body class="h-100 bg-dark">

    <!-- ---------------- Bavckground Video section ------------------- -->
    <div id="myVid">
        <video autoplay muted loop id="myVideo">
            <source src="FeelingsBack.mp4" type="video/mp4">
        </video>
    </div>
    <!-- ---------------- Bavckground Video section ------------------- -->

    <div>
        <!-- ---------------- navigation section ----------------- -->
        <header id="background" class="mb-auto rounded bg-secondary bg-opacity-25 fixed-top">
            <div>
                <h3 class="float-md-start mt-2 mx-4 text-center">Bored?
                </h3>
                <nav class="nav nav-masthead justify-content-center mt-2 float-md-end">
                    <a class="nav-link active" aria-current="page" href="index.html">BoredRoom</a>
                    <a class="nav-link" href="Feelings.html">Feelings</a>
                    <a class="nav-link" href="form.html">Remember Me!</a>
                </nav>
            </div>
        </header>
        <!-- ---------------- navigation section ----------------- -->
    </div>


    <div class="container text-light pt-5">
        <div class="row">
            <main>
                <div class="shadow-lg bg-dark bg-opacity-50 rounded-3 p-5">
                    <h4 class="mb-3">Remember Me!</h4>
                    <form name="myForm" id="myForm" target="_blank" class="needs-validation" method="POST"
                        action="https://dev.itas.ca/~brandon.brown/ITAS191/processForm.php" novalidate>
                        <div class="row g-3">
                            <div class="col-sm-6">
                                <label for="firstName" class="form-label">First name</label>
                                <input type="text" class="form-control" id="firstName" placeholder="" value="" required>
                                <div class="invalid-feedback">
                                    Valid first name is required.
                                </div>
                            </div>

                            <div class="col-sm-6">
                                <label for="lastName" class="form-label">Last name</label>
                                <input type="text" class="form-control" id="lastName" placeholder="" value="" required>
                                <div class="invalid-feedback">
                                    Valid last name is required.
                                </div>
                            </div>


                            <div class="col-12">
                                <label for="email" class="form-label" id="email">Email</label>
                                <input type="email" class="form-control" id="email" placeholder="you@example.com"
                                    required>
                                <div class="invalid-feedback">
                                    Please enter a valid email address.
                                </div>
                            </div>

                            <div class="col-12">
                                <label for="subject">Write how you feel now and how you want to be in One year from
                                    now</label>
                                <textarea class="form-control" id="feeling" name="feeling"
                                    placeholder="Write something.." rows="5"></textarea>
                            </div>

                            <hr class="my-3">
                            <p>Tell me if you are thinking of a trip!<br></p>
                            <div class="col-md-5">
                                <label for="country" class="form-label">Where you want to go?</label>
                                <select id="countries" name="countries"></select>
                                <div class="invalid-feedback">
                                    Please select a valid country.
                                </div>
                            </div>

                            <hr class="my-3">
                            <p>Today is <span class="text-warning" id='date-time'></span>.</p>
                            <div>
                                <div class="form-check">
                                    <input type="radio" class="form-check-input" id="good" name="optradio"
                                        value="option1" checked>
                                    <label class="form-check-label" for="radio1">I feel awesome today :)</label>
                                </div>

                                <div class="form-check">
                                    <input type="radio" class="form-check-input" id="bad" name="optradio"
                                        value="option2">
                                    <label class="form-check-label" for="radio2">I feel blue today :(</label>
                                </div>
                            </div>
                            <hr class="my-4">
                            <button class="w-100 btn btn-outline-success btn-lg" id="elemId" type="submit">Do
                                it!</button>
                        </div>
                    </form>
                </div>
            </main>
        </div>
    </div>

    <div class="container">
        <div class="m-2 mb-2 text-light text-center bg-dark bg-opacity-25 rounded-3">
            <p><span class="text-white" onclick="submit" id='countdown'> how many days is left?</span></p>
            <p id="formData"></p>
        </div>
    </div>

    <script>
        // ------------------ Random Color Generator section -----------------------

        const background = document.getElementById("background");

        const getRandomNumber = (maxNum) => {
            return Math.floor(Math.random() * maxNum);
        };

        const getRandomColor = () => {
            const h = getRandomNumber(360);
            const s = getRandomNumber(100);
            const l = getRandomNumber(100);

            return `hsl(${h}deg, ${s}%, ${l}%)`;
        };

        const setBackgroundColor = () => {
            const randomColor = getRandomColor();
            background.style.backgroundColor = randomColor;
            background.style.color = randomColor;
        };

        setBackgroundColor();

        setInterval(() => {
            setBackgroundColor();
        }, 3000);

            // ------------------ Random Color Generator section -----------------------
    </script>


    <script type="module">

        //Listening/waitig for the document to be ready
        document.addEventListener('DOMContentLoaded', async () => {

            const selectDrop = document.querySelector('#countries');
            // const selectDrop = document.getElementById('countries');

            let retry = true;
            let countries = [];
            let attempt = 0;

            while (retry && attempt < 6) {
                attempt++
                console.info(`attempt ${attempt}`);
                try {
                    const response = await fetch('https://restcountries.com/v3.1/all');
                    const data = await response.json();
                    data.forEach((country) => {
                        countries.push(country.name.common);
                    });

                } catch (e) {
                    console.error(e);
                } finally {
                    if (countries.length > 0) {
                        retry = false;
                        console.log(countries);
                        let output = "";
                        countries.forEach(country => {
                            output += `<option value="${country}">${country}</option>`;
                        })
                        selectDrop.innerHTML = output;
                    }
                }
            }

        });


    </script>


    <!-- ------------------ Date Section -------------------- -->
    <script>
        const dt = new Date();
        document.getElementById('date-time').innerHTML = dt;

    </script>
    <!-- ------------------ Date Section -------------------- -->

    <!-- --------------------- countDown Section ------------------ -->
    <script>

        let timerElem = document.getElementById('elemId');
        const startTime = new Date().getTime();
        timerElem.onclick = function (event) {
            event.preventDefault();
            alert('Your form has been submitted!');
            const firstValue = document.getElementById('firstName').value;
            const familyValue = document.getElementById('lastName').value;
            // document.getElementById('formData').innerHTML=firstValue;

            let countDwn = setInterval(() => {
                const tr = new Date().getTime();
                let countDownDate = startTime + (365 * 24 * 60 * 60 * 1000) - tr;
                let timeleft = countDownDate;

                let days = Math.floor(timeleft / (1000 * 60 * 60 * 24));
                let hours = Math.floor((timeleft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                let minutes = Math.floor((timeleft % (1000 * 60 * 60)) / (1000 * 60));
                let seconds = Math.floor((timeleft % (1000 * 60)) / 1000);
                document.getElementById('countdown').innerHTML = days + " Days left to send the email again" + " " + firstValue;
            }, 1000)
        }
        // ----------------- Resubmitting ------------------
        if (timeleft = 0) {
            window.onload = function () {
                let auto = setTimeout(function () { autoRefresh(); }, 100);

                function submitform() {
                    alert('The form is submiting eventually');
                    document.forms["myForm"].submit();
                }

                function autoRefresh() {
                    clearTimeout(auto);
                    auto = setTimeout(function () { submitform(); autoRefresh(); }, 1000);
                }
            }
        }
        // ----------------- Resubmitting ------------------

    </script>
    <!-- --------------------- countDown Section ------------------ -->

    <script>
        // ------------- video Script ---------------

        // Get the video
        let video = document.getElementById("myVideo");
        // play the video
        function myFunction() {
            video.play();
        }

            // ------------- video Script ---------------
    </script>

    <div class="mt-5 text-center text-white-50">
        <footer>
            <p> Background video is a great art by <a href="https://www.pexels.com/video/colored-liquid-mixing-3938584/"
                    class="text-white">StefWithAnF.</a> </p>
        </footer>
    </div>
</body>

</html>